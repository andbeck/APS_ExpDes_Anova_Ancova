<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Design and Analysis of Experiments | An Introduction to Experimental Design and Linear Models</title>
  <meta name="description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Design and Analysis of Experiments | An Introduction to Experimental Design and Linear Models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Design and Analysis of Experiments | An Introduction to Experimental Design and Linear Models" />
  
  <meta name="twitter:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

<meta name="author" content="Andrew P Beckerman (based on text and slides from Mark Rees and Gareth Phoenix)" />


<meta name="date" content="2021-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="examples-and-challenge-questions.html"/>
<link rel="next" href="randomized-complete-block-design-rcb.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">And Introduction to Experimental Design and Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#the-three-rs"><i class="fa fa-check"></i><b>1.0.1</b> The Three Rs</a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#the-general-linear-model"><i class="fa fa-check"></i><b>1.0.2</b> The General Linear Model</a></li>
<li class="chapter" data-level="1.0.3" data-path="index.html"><a href="index.html#section-readings--"><i class="fa fa-check"></i><b>1.0.3</b> Section Readings —-</a></li>
<li class="chapter" data-level="1.0.4" data-path="index.html"><a href="index.html#install-some-extra-packages--"><i class="fa fa-check"></i><b>1.0.4</b> Install some extra packages —-</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction To Experiments (Some Philosophy)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#how-to-think-about-experiments-components-of-an-experiment"><i class="fa fa-check"></i><b>2.1</b> How to think about experiments: Components of an Experiment</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#how-do-we-increase-precision-and-reduce-bias"><i class="fa fa-check"></i><b>2.1.1</b> How do we increase precision and reduce bias?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#experimental-vs-measurement-units"><i class="fa fa-check"></i><b>2.2</b> Experimental vs Measurement units</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#take-home-message-randomization-properly-with-replication-protects-against-confounding"><i class="fa fa-check"></i><b>2.2.1</b> Take Home Message: Randomization properly with Replication protects against Confounding</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#a-non-randomized-experiment-haphazard-is-not-randomized"><i class="fa fa-check"></i><b>2.2.2</b> A non-randomized experiment – <strong>haphazard</strong> is NOT randomized</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#mini-quiz"><i class="fa fa-check"></i><b>2.3</b> Mini-Quiz</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#replication-how-many"><i class="fa fa-check"></i><b>2.4</b> Replication: How many?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="standard-errors-precision-and-sampling.html"><a href="standard-errors-precision-and-sampling.html"><i class="fa fa-check"></i><b>3</b> Standard Errors, Precision and Sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="standard-errors-precision-and-sampling.html"><a href="standard-errors-precision-and-sampling.html#standard-errors-and-precision"><i class="fa fa-check"></i><b>3.1</b> Standard Errors and precision</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="standard-errors-precision-and-sampling.html"><a href="standard-errors-precision-and-sampling.html#se-of-a-difference-and-balance."><i class="fa fa-check"></i><b>3.1.1</b> SE of a Difference and Balance.</a></li>
<li class="chapter" data-level="3.1.2" data-path="standard-errors-precision-and-sampling.html"><a href="standard-errors-precision-and-sampling.html#however-sometimes-unbalanced-designs-are-better."><i class="fa fa-check"></i><b>3.1.2</b> However sometimes unbalanced designs are better.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="standard-errors-precision-and-sampling.html"><a href="standard-errors-precision-and-sampling.html#the-crd-completely-randomised-design"><i class="fa fa-check"></i><b>3.2</b> The CRD: Completely Randomised Design</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html"><i class="fa fa-check"></i><b>4</b> Examples and Challenge Questions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html#designing-your-first-experiment"><i class="fa fa-check"></i><b>4.1</b> Designing your first experiment</a></li>
<li class="chapter" data-level="4.2" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html#using-r-to-generate-experimental-designs"><i class="fa fa-check"></i><b>4.2</b> Using R to generate Experimental Designs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>5</b> Design and Analysis of Experiments</a>
<ul>
<li class="chapter" data-level="5.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-up-data"><i class="fa fa-check"></i><b>5.1.1</b> Making up data</a></li>
<li class="chapter" data-level="5.1.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#into-the-dplyr-and-ggplot-pipeline."><i class="fa fa-check"></i><b>5.1.2</b> Into the dplyr and ggplot pipeline.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-one-way-anova."><i class="fa fa-check"></i><b>5.2</b> The One-Way ANOVA.</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-insight-and-inference"><i class="fa fa-check"></i><b>5.2.1</b> Making insight and inference</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#a-priori-vs.-post-hoc-contrasts"><i class="fa fa-check"></i><b>5.3</b> A priori vs. Post-Hoc Contrasts</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-more-appropriate-approach."><i class="fa fa-check"></i><b>5.3.1</b> The more appropriate approach.</a></li>
<li class="chapter" data-level="5.3.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#comparing-the-average-of-the-herbicide-effect-with-the-control."><i class="fa fa-check"></i><b>5.3.2</b> comparing the average of the herbicide effect with the control.</a></li>
<li class="chapter" data-level="5.3.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#writing-this-up"><i class="fa fa-check"></i><b>5.3.3</b> writing this up…</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html"><i class="fa fa-check"></i><b>6</b> Randomized Complete Block design (RCB)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#an-example-of-the-rcbd"><i class="fa fa-check"></i><b>6.1</b> An example of the RCBD</a></li>
<li class="chapter" data-level="6.2" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#analysing-the-crbd"><i class="fa fa-check"></i><b>6.2</b> Analysing the CRBD</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#building-the-model"><i class="fa fa-check"></i><b>6.2.1</b> Building the model</a></li>
<li class="chapter" data-level="6.2.2" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#are-the-estimates-of-the-parameters-what-we-expect"><i class="fa fa-check"></i><b>6.2.2</b> Are the estimates of the parameters what we expect?</a></li>
<li class="chapter" data-level="6.2.3" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#correct-standard-errors-for-a-figure"><i class="fa fa-check"></i><b>6.2.3</b> Correct Standard Errors for a Figure</a></li>
<li class="chapter" data-level="6.2.4" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#making-inference-confidence-intervals-and-contrasts"><i class="fa fa-check"></i><b>6.2.4</b> Making inference: confidence intervals and contrasts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-latin-square-design-lsd.html"><a href="the-latin-square-design-lsd.html"><i class="fa fa-check"></i><b>7</b> The Latin Square Design (LSD)</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="the-latin-square-design-lsd.html"><a href="the-latin-square-design-lsd.html#fitting-the-model"><i class="fa fa-check"></i><b>7.0.1</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html"><i class="fa fa-check"></i><b>8</b> Designs for testing for interactions: factorial designs.</a>
<ul>
<li class="chapter" data-level="8.1" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#introducing-interactions"><i class="fa fa-check"></i><b>8.1</b> Introducing Interactions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#lets-design-an-experiment-again"><i class="fa fa-check"></i><b>8.1.1</b> Let’s design an experiment, again…</a></li>
<li class="chapter" data-level="8.1.2" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#the-factorial-design-how-and-why-study-interactions"><i class="fa fa-check"></i><b>8.1.2</b> The Factorial Design: How and Why Study Interactions?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#a-factorial-design-and-the-two-way-anova"><i class="fa fa-check"></i><b>8.2</b> A Factorial Design and the Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#build-the-data"><i class="fa fa-check"></i><b>8.2.1</b> Build the Data</a></li>
<li class="chapter" data-level="8.2.2" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#plot-the-data"><i class="fa fa-check"></i><b>8.2.2</b> Plot the data!</a></li>
<li class="chapter" data-level="8.2.3" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#analyse-the-data"><i class="fa fa-check"></i><b>8.2.3</b> Analyse the data</a></li>
<li class="chapter" data-level="8.2.4" data-path="designs-for-testing-for-interactions-factorial-designs-.html"><a href="designs-for-testing-for-interactions-factorial-designs-.html#final-figuring"><i class="fa fa-check"></i><b>8.2.4</b> final figuring</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="experimental-design-and-anova-a-summary.html"><a href="experimental-design-and-anova-a-summary.html"><i class="fa fa-check"></i><b>9</b> Experimental Design and ANOVA - A Summary</a>
<ul>
<li class="chapter" data-level="9.1" data-path="experimental-design-and-anova-a-summary.html"><a href="experimental-design-and-anova-a-summary.html#how-to-analyse-anova-models"><i class="fa fa-check"></i><b>9.1</b> How To Analyse ANOVA models</a></li>
<li class="chapter" data-level="9.2" data-path="experimental-design-and-anova-a-summary.html"><a href="experimental-design-and-anova-a-summary.html#experimental-designs."><i class="fa fa-check"></i><b>9.2</b> Experimental Designs.</a></li>
<li class="chapter" data-level="9.3" data-path="experimental-design-and-anova-a-summary.html"><a href="experimental-design-and-anova-a-summary.html#clever-r-stuff"><i class="fa fa-check"></i><b>9.3</b> Clever R Stuff</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html"><i class="fa fa-check"></i><b>10</b> Introducing the ANCOVA - the analysis of covariance</a>
<ul>
<li class="chapter" data-level="10.1" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#setting-up-the-various-ideas."><i class="fa fa-check"></i><b>10.1</b> Setting up the various ideas.</a></li>
<li class="chapter" data-level="10.2" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#working-through-and-example."><i class="fa fa-check"></i><b>10.2</b> Working through and example.</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#get-the-data-and-make-your-picture"><i class="fa fa-check"></i><b>10.2.1</b> Get the data and make your picture</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#building-the-model-and-understanding-it"><i class="fa fa-check"></i><b>10.3</b> Building the model (and understanding it)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#dealing-with-some-issues-with-residuals."><i class="fa fa-check"></i><b>10.3.1</b> Dealing with some issues with residuals.</a></li>
<li class="chapter" data-level="10.3.2" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#making-inference-on-the-ancova"><i class="fa fa-check"></i><b>10.3.2</b> Making inference on the ANCOVA</a></li>
<li class="chapter" data-level="10.3.3" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#the-summary-table-and-making-sense-of-the-log-stuff."><i class="fa fa-check"></i><b>10.3.3</b> The summary table and making sense of the log stuff.</a></li>
<li class="chapter" data-level="10.3.4" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#the-equations-supported-by-the-model."><i class="fa fa-check"></i><b>10.3.4</b> The equations supported by the model.</a></li>
<li class="chapter" data-level="10.3.5" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#making-even-more-inference-and-drawing-the-picture"><i class="fa fa-check"></i><b>10.3.5</b> Making even more inference and drawing the picture</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#some-general-principles"><i class="fa fa-check"></i><b>10.4</b> Some General Principles</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#ancova-always-tests-the-interaction-against-the-additive-model"><i class="fa fa-check"></i><b>10.4.1</b> ANCOVA always tests the interaction against the additive model</a></li>
<li class="chapter" data-level="10.4.2" data-path="introducing-the-ancova-the-analysis-of-covariance.html"><a href="introducing-the-ancova-the-analysis-of-covariance.html#specifying-models-in-r"><i class="fa fa-check"></i><b>10.4.2</b> Specifying models in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html"><i class="fa fa-check"></i><b>11</b> Nonlinearities, polynomials and regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#transformations---a-reminder-and-starting-point."><i class="fa fa-check"></i><b>11.1</b> Transformations - a reminder and starting point.</a></li>
<li class="chapter" data-level="11.2" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#working-through-an-example."><i class="fa fa-check"></i><b>11.2</b> Working through an example.</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#interlude-1---inference-before-fixing-the-problem"><i class="fa fa-check"></i><b>11.2.1</b> Interlude 1 - Inference before fixing the problem</a></li>
<li class="chapter" data-level="11.2.2" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#solving-the-problem-i-the-non-linearity"><i class="fa fa-check"></i><b>11.2.2</b> Solving the Problem I: The Non-linearity</a></li>
<li class="chapter" data-level="11.2.3" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#interlude-2---inference-before-fixing-both-problems"><i class="fa fa-check"></i><b>11.2.3</b> Interlude 2 - Inference before fixing both problems</a></li>
<li class="chapter" data-level="11.2.4" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#solving-the-problem-ii-non-constant---increasing-variance"><i class="fa fa-check"></i><b>11.2.4</b> Solving the Problem II: Non-constant - increasing variance</a></li>
<li class="chapter" data-level="11.2.5" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#interlude-3---inference-with-both-things-corrected."><i class="fa fa-check"></i><b>11.2.5</b> Interlude 3 - Inference with both things corrected.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#anova-tables-with-multiple-explantory-variables."><i class="fa fa-check"></i><b>11.3</b> Anova Tables with multiple explantory variables.</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#explaining-the-trick"><i class="fa fa-check"></i><b>11.3.1</b> Explaining the Trick</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#types-of-anova"><i class="fa fa-check"></i><b>11.4</b> Types of ANOVA</a></li>
<li class="chapter" data-level="11.5" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#explaining-the-result---a-dose-of-reality"><i class="fa fa-check"></i><b>11.5</b> Explaining the result - a dose of reality</a></li>
<li class="chapter" data-level="11.6" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#a-mechanistic-model"><i class="fa fa-check"></i><b>11.6</b> A mechanistic model</a></li>
<li class="chapter" data-level="11.7" data-path="nonlinearities-polynomials-and-regression.html"><a href="nonlinearities-polynomials-and-regression.html#the-take-home-messages"><i class="fa fa-check"></i><b>11.7</b> The Take Home Messages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="a-final-overview.html"><a href="a-final-overview.html"><i class="fa fa-check"></i><b>12</b> A final Overview</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Experimental Design and Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="design-and-analysis-of-experiments" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Design and Analysis of Experiments</h1>
<p>In this section, we will design and experiment, make up data for the experiment, and analyse the experiment.</p>
<p>This is a very good process to go through - you will understand more fully how to generate randomisation in your experiments, and you will better understand how data that you collect is <em>structured</em> - from where does variation come in your measurements.</p>
<p>Another way to think about this is to consider that we are learning how statistics looks at data you’ve collected. We are going to make up data, where we know the answer to the question. Then we are going to plot these data, and analyse them.</p>
<div id="example-one" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Example one</h2>
<p>We are now going to cheat by generating artificial data we we don’t have time to go run the experiment.</p>
<p>The experiment is about plant biomass yield under several herbicide treatments: a control and two herbicides, and a third treatment that is a placebo - applied water but no herbicide. The hypothesis is….?</p>
<p>Start a new section of your script (some hashes) called Herbicide Example.</p>
<p>Now, enter the following code in your script file, then run it.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="design-and-analysis-of-experiments.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the random seed - this will ensure that your results and mine here are the same.</span></span>
<span id="cb7-2"><a href="design-and-analysis-of-experiments.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-3"><a href="design-and-analysis-of-experiments.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="design-and-analysis-of-experiments.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#treatment names we have a control and two herbicides, Herb3 is a placebo (applied water but no herbicide)</span></span>
<span id="cb7-5"><a href="design-and-analysis-of-experiments.html#cb7-5" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Cont&quot;</span>,<span class="st">&quot;Herb1&quot;</span>,<span class="st">&quot;Herb2&quot;</span>,<span class="st">&quot;Placebo&quot;</span>)</span>
<span id="cb7-6"><a href="design-and-analysis-of-experiments.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="design-and-analysis-of-experiments.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#number of replicates</span></span>
<span id="cb7-8"><a href="design-and-analysis-of-experiments.html#cb7-8" aria-hidden="true" tabindex="-1"></a>Nreps <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb7-9"><a href="design-and-analysis-of-experiments.html#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="design-and-analysis-of-experiments.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Total number of experimental units</span></span>
<span id="cb7-11"><a href="design-and-analysis-of-experiments.html#cb7-11" aria-hidden="true" tabindex="-1"></a>Total.units <span class="ot">&lt;-</span> Nreps <span class="sc">*</span> <span class="fu">length</span>(treat)</span>
<span id="cb7-12"><a href="design-and-analysis-of-experiments.html#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="design-and-analysis-of-experiments.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Our completely randomized design</span></span>
<span id="cb7-14"><a href="design-and-analysis-of-experiments.html#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># not the trick of adding the $book at the end of the code</span></span>
<span id="cb7-15"><a href="design-and-analysis-of-experiments.html#cb7-15" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">design.crd</span>(treat, Nreps, <span class="at">serie =</span> <span class="dv">0</span>)<span class="sc">$</span>book</span>
<span id="cb7-16"><a href="design-and-analysis-of-experiments.html#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="design-and-analysis-of-experiments.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># check it out (the first 10 rows)</span></span>
<span id="cb7-18"><a href="design-and-analysis-of-experiments.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    plots r   treat
## 1      1 1    Cont
## 2      2 1   Herb1
## 3      3 2   Herb1
## 4      4 1 Placebo
## 5      5 2 Placebo
## 6      6 3 Placebo
## 7      7 3   Herb1
## 8      8 2    Cont
## 9      9 1   Herb2
## 10    10 2   Herb2</code></pre>
<div id="making-up-data" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Making up data</h3>
<p>Right, lets make up some artificial data so we know the right answers – this is a very good way of checking you understand what’s going on.</p>
<p>First, lets define some randon variation centred around 0 with a standard deviation of 3:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="design-and-analysis-of-experiments.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Our experimental errors, normal distribution mean = 0, standard deviation = 3</span></span>
<span id="cb9-2"><a href="design-and-analysis-of-experiments.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rnorm is random normal distribution - the bell curve!</span></span>
<span id="cb9-3"><a href="design-and-analysis-of-experiments.html#cb9-3" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(Total.units, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Now we need to actually generate a response variable. The thing we ‘measured.’ For this experiment we are <em>measuring</em> yield - the grams of dry biomass at the end of the experimental season.</p>
<p>To do this, we have to think about the mean of the yield (we’ll set it to 20), the deviation caused by Herbicide 1 (+5 average yield), the deviation caused by Herbicide 2 (+6 average yield) and the deviation caused by the placebo (nothing) and the error among observations (error). If this works, there should be Controls and Placebos with values around 20, and Herbicide values around ±25-26. But keep in mind… we have a standard deviation of 3 in the error… what will that do? Let’s see.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="design-and-analysis-of-experiments.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the observations of yield</span></span>
<span id="cb10-2"><a href="design-and-analysis-of-experiments.html#cb10-2" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>obs <span class="ot">&lt;-</span> </span>
<span id="cb10-3"><a href="design-and-analysis-of-experiments.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mean yield Control</span></span>
<span id="cb10-4"><a href="design-and-analysis-of-experiments.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">20</span> <span class="sc">+</span> </span>
<span id="cb10-5"><a href="design-and-analysis-of-experiments.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># deviation caused by Herbicide 1</span></span>
<span id="cb10-6"><a href="design-and-analysis-of-experiments.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  (design<span class="sc">$</span>treat<span class="sc">==</span><span class="st">&quot;Herb1&quot;</span>) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb10-7"><a href="design-and-analysis-of-experiments.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  (design<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">&quot;Herb2&quot;</span>) <span class="sc">*</span> <span class="dv">6</span> <span class="sc">+</span> </span>
<span id="cb10-8"><a href="design-and-analysis-of-experiments.html#cb10-8" aria-hidden="true" tabindex="-1"></a>  (design<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">&quot;Placebo&quot;</span>)<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb10-9"><a href="design-and-analysis-of-experiments.html#cb10-9" aria-hidden="true" tabindex="-1"></a>  error</span>
<span id="cb10-10"><a href="design-and-analysis-of-experiments.html#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="design-and-analysis-of-experiments.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># look at it</span></span>
<span id="cb10-12"><a href="design-and-analysis-of-experiments.html#cb10-12" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>obs</span></code></pre></div>
<pre><code>##   [1] 25.56702 23.32992 23.39985 21.54529 20.96267 22.34314 24.19572 15.45247
##   [9] 28.25849 28.09586 25.03735 26.36961 20.44643 16.30186 25.99108 29.62076
##  [17] 24.05645 22.01011 25.48992 29.60826 25.83590 23.77995 21.06598 21.85137
##  [25] 19.10903 20.54631 21.71607 24.78175 15.84089 24.56500 26.21161 19.96028
##  [33] 16.21851 24.50682 17.80657 23.74981 30.64518 24.90522 27.33204 18.15174
##  [41] 13.41104 27.87253 19.64131 22.48390 25.17527 15.41037 16.58438 15.85613
##  [49] 20.56557 20.75066 19.84848 19.97868 22.47068 25.11759 25.55048 24.92058
##  [57] 18.45873 22.02616 23.09377 15.56172 26.78291 18.20024 21.20411 25.58635
##  [65] 25.67710 26.29930 22.20238 20.63010 30.71839 18.37104 29.64641 14.20080
##  [73] 30.80997 22.67665 29.92778 20.63348 21.45997 20.32328 25.25901 18.08680
##  [81] 18.75511 24.83941 27.00049 23.06356 27.87863 18.63813 16.75083 24.45870
##  [89] 19.76979 23.40537 21.49970 21.09057 18.48304 18.64256 23.66625 28.52046
##  [97] 18.82317 29.38274 22.55174 26.41338 25.95806 24.86078 21.90836 20.61218
## [105] 25.47680 21.99004 23.06115 20.40581 15.70540 23.30232 28.04868 18.26389
## [113] 30.76203 24.50311 19.17553 25.11028 26.65809 18.84203 26.01325 26.79324</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="design-and-analysis-of-experiments.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the design now.</span></span>
<span id="cb12-2"><a href="design-and-analysis-of-experiments.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design)</span></code></pre></div>
<pre><code>##   plots r   treat      obs
## 1     1 1    Cont 25.56702
## 2     2 1   Herb1 23.32992
## 3     3 2   Herb1 23.39985
## 4     4 1 Placebo 21.54529
## 5     5 2 Placebo 20.96267
## 6     6 3 Placebo 22.34314</code></pre>
</div>
<div id="into-the-dplyr-and-ggplot-pipeline." class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Into the dplyr and ggplot pipeline.</h3>
<p>Great stuff. Now we can move to our standard data management and visualisation pipeline.</p>
<ol style="list-style-type: decimal">
<li>review the data</li>
<li>sumamrise the data with dplyr - generate means and se’s for the treatments</li>
<li>visualise with ggplot2</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="design-and-analysis-of-experiments.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the data</span></span>
<span id="cb14-2"><a href="design-and-analysis-of-experiments.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(design)</span></code></pre></div>
<pre><code>## Rows: 120
## Columns: 4
## $ plots &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …
## $ r     &lt;int&gt; 1, 1, 2, 1, 2, 3, 3, 2, 1, 2, 3, 4, 4, 4, 5, 5, 6, 3, 5, 6, 7, …
## $ treat &lt;chr&gt; &quot;Cont&quot;, &quot;Herb1&quot;, &quot;Herb1&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Her…
## $ obs   &lt;dbl&gt; 25.56702, 23.32992, 23.39985, 21.54529, 20.96267, 22.34314, 24.…</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="design-and-analysis-of-experiments.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise to get means and ses</span></span>
<span id="cb16-2"><a href="design-and-analysis-of-experiments.html#cb16-2" aria-hidden="true" tabindex="-1"></a>sumDat <span class="ot">&lt;-</span> design <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="design-and-analysis-of-experiments.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treat) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="design-and-analysis-of-experiments.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-5"><a href="design-and-analysis-of-experiments.html#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanYield =</span> <span class="fu">mean</span>(obs),</span>
<span id="cb16-6"><a href="design-and-analysis-of-experiments.html#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">seYield =</span> <span class="fu">sd</span>(obs)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>())</span>
<span id="cb16-7"><a href="design-and-analysis-of-experiments.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="design-and-analysis-of-experiments.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the raw data and the mean±se</span></span>
<span id="cb18-2"><a href="design-and-analysis-of-experiments.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># start with the mean±se and then add the raw data</span></span>
<span id="cb18-3"><a href="design-and-analysis-of-experiments.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumDat, <span class="fu">aes</span>(<span class="at">x =</span> treat, <span class="at">y =</span> meanYield))<span class="sc">+</span></span>
<span id="cb18-4"><a href="design-and-analysis-of-experiments.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb18-5"><a href="design-and-analysis-of-experiments.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> sumDat, <span class="fu">aes</span>(<span class="at">ymin =</span> meanYield <span class="sc">-</span> seYield, <span class="at">ymax =</span> meanYield<span class="sc">+</span>seYield),</span>
<span id="cb18-6"><a href="design-and-analysis-of-experiments.html#cb18-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb18-7"><a href="design-and-analysis-of-experiments.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> design, <span class="fu">aes</span>(<span class="at">x =</span> treat, <span class="at">y =</span> obs), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="Introduction-to-Experimental-Design-and-Analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>A few things to notice.</p>
<ol style="list-style-type: decimal">
<li>The data are quite variable and the means of the herbicide treatments are roughly 5 and 6 units higher. This is as we expected….</li>
<li>The standard errors are quite small! Why is that!?</li>
<li>For those of you interested in some extra reading and thinking, the 95% Confidence Interval around the means can be calculated using <code>1.96*SE</code> == <code>1.96*sd(obs)/sqrt(n())</code>. Go ahead and do that and look into that if you want…</li>
</ol>
</div>
</div>
<div id="the-one-way-anova." class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The One-Way ANOVA.</h2>
<p>If you’ve been paying attention, we’ve essentially designed and plotted the data for a 1-way ANOVA. These data are very similar to the daphnia parasite data we finished semester 1 with.</p>
<p>To analyse these data, we use the <code>lm()</code> function to build the model, check assumptions, and then make inference. Let’s go.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="design-and-analysis-of-experiments.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model</span></span>
<span id="cb19-2"><a href="design-and-analysis-of-experiments.html#cb19-2" aria-hidden="true" tabindex="-1"></a>modYield <span class="ot">&lt;-</span> <span class="fu">lm</span>(obs <span class="sc">~</span> treat, <span class="at">data =</span> design)</span>
<span id="cb19-3"><a href="design-and-analysis-of-experiments.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="design-and-analysis-of-experiments.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># assumptions</span></span>
<span id="cb19-5"><a href="design-and-analysis-of-experiments.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(modYield)</span></code></pre></div>
<p><img src="Introduction-to-Experimental-Design-and-Analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="design-and-analysis-of-experiments.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inference: anova</span></span>
<span id="cb20-2"><a href="design-and-analysis-of-experiments.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modYield)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: obs
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## treat       3  888.39 296.129  31.968 3.905e-15 ***
## Residuals 116 1074.54   9.263                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="design-and-analysis-of-experiments.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb22-2"><a href="design-and-analysis-of-experiments.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modYield)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = obs ~ treat, data = design)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.5589 -1.8698  0.1395  2.0230  6.3494 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.6087     0.5557  35.288  &lt; 2e-16 ***
## treatHerb1     5.1019     0.7858   6.492 2.18e-09 ***
## treatHerb2     6.5048     0.7858   8.277 2.43e-13 ***
## treatPlacebo   0.9993     0.7858   1.272    0.206    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.044 on 116 degrees of freedom
## Multiple R-squared:  0.4526, Adjusted R-squared:  0.4384 
## F-statistic: 31.97 on 3 and 116 DF,  p-value: 3.905e-15</code></pre>
<div id="making-insight-and-inference" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Making insight and inference</h3>
<p>Lets walks through things very discretely.</p>
<ol style="list-style-type: decimal">
<li>Our graph suggests that herbicide treatments have an effect of increasing yield.</li>
<li>Our model is designed to test this hypothesis - are any of the differences among means non-zero?</li>
<li>Our hypothesis is probably really about whether the herbicide and placebos are differnt than the controls</li>
<li>Our diagnostics are fantistic… the best you’ve ever seen.</li>
<li>The Anova Table confirms that there are differences - we can reject the null hypothesis</li>
<li>The summary table confirms that Herb1 and Herb2 are both larger than controls and the Placebo is not.</li>
</ol>
<p>How do we interpret even more? The estimate associated with Control is 20! Just where it should be.</p>
<p>The estimates associated with Herb1, Herb2 and Placebo are the differences between the mean of these treatments and the control (the reference level!). These differences are positive for Herb1 and Herb2, close to 5 and 6 respectively (as expected) and this positive difference is not 0 via the statistical test.</p>
<p>However, the differnce for Placebo is close to 0 and therefore we can not reject the null hypothesis test that it differs from control. GENUIS!</p>
</div>
</div>
<div id="a-priori-vs.-post-hoc-contrasts" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> A priori vs. Post-Hoc Contrasts</h2>
<p>In the semester 1, we introduced how to do a Tukey Test.</p>
<p>This is known as an <em>a posteriori</em> test – testing the significance of things suggested by the experiment, also known as data snooping or data dredging. These are multiple comparison methods (Bonferroni, Scheffe method, Tukey honest significant difference, Duncan’s multiple range test) which try to control the chance of getting a significant result by chance.</p>
<p>To understand the risks of these, consider this experimental design. We have 7 treatments. With 7 treatments, there are 21 pairwise comparisons. With p-value threshold of <span class="math inline">\(0.05\)</span> we expect 1/20 (5/100) tests to be significant. So with this 7 treatment and 21 comparison design, would you expect a signficant result by chance? You betyja.</p>
<p>This is why, unless a priori (in advance) you can justify ALL pairwise comparisons, a tukey test may not be appropriate.</p>
<p>Some statisticians really don’t like them “In my view multiple comparison methods have no place at all in the interpretation of data” Nelder (very well respected statistician).</p>
<div id="the-more-appropriate-approach." class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> The more appropriate approach.</h3>
<p>The classical approach is to specify a priori (before experiment) a set of hypotheses then test them using contrasts. For our experiment, as noted above, we were probably interested in what our treatment contrasts provided - tests of difference with the control.</p>
<p>Specifying specific contrasts is easy once you get your head around the ‘structure’ of the syntax. Lets have a go with specifying a comparison JUST between Herbicide 1 and the control.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="design-and-analysis-of-experiments.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the levels and ORDERING of the treatments</span></span>
<span id="cb24-2"><a href="design-and-analysis-of-experiments.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(design<span class="sc">$</span>treat)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="design-and-analysis-of-experiments.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb26-2"><a href="design-and-analysis-of-experiments.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare control with herbicide 1.... and ignore the Herb2 and Placebo</span></span>
<span id="cb26-3"><a href="design-and-analysis-of-experiments.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the reference -1 and the &#39;other&#39; 1.</span></span>
<span id="cb26-4"><a href="design-and-analysis-of-experiments.html#cb26-4" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb26-5"><a href="design-and-analysis-of-experiments.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="design-and-analysis-of-experiments.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb26-7"><a href="design-and-analysis-of-experiments.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                      Estimate Std. Error  t value     Pr(&gt;|t|)
## treat c=( -1 1 0 0 ) 5.101935  0.7858436 6.492304 2.181992e-09
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="design-and-analysis-of-experiments.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remind ourselves of the contrast from the summary table</span></span>
<span id="cb28-2"><a href="design-and-analysis-of-experiments.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modYield)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = obs ~ treat, data = design)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.5589 -1.8698  0.1395  2.0230  6.3494 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.6087     0.5557  35.288  &lt; 2e-16 ***
## treatHerb1     5.1019     0.7858   6.492 2.18e-09 ***
## treatHerb2     6.5048     0.7858   8.277 2.43e-13 ***
## treatPlacebo   0.9993     0.7858   1.272    0.206    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.044 on 116 degrees of freedom
## Multiple R-squared:  0.4526, Adjusted R-squared:  0.4384 
## F-statistic: 31.97 on 3 and 116 DF,  p-value: 3.905e-15</code></pre>
<blockquote>
<p>Notice that the results are the same from the summary(modYield) and the fit.contrast.</p>
</blockquote>
<p>If we want to compare the two herbicides we can use this approach. Note in advance that this contrast DOES NOT exist in the summary table!</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="design-and-analysis-of-experiments.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb30-2"><a href="design-and-analysis-of-experiments.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare herb1 with herb2, ignoring the control and placebo.</span></span>
<span id="cb30-3"><a href="design-and-analysis-of-experiments.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the reference -1 and the &#39;other&#39; 1.</span></span>
<span id="cb30-4"><a href="design-and-analysis-of-experiments.html#cb30-4" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb30-5"><a href="design-and-analysis-of-experiments.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="design-and-analysis-of-experiments.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb30-7"><a href="design-and-analysis-of-experiments.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                      Estimate Std. Error  t value   Pr(&gt;|t|)
## treat c=( 0 -1 1 0 ) 1.402879  0.7858436 1.785189 0.07684408
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>Isn’t this cool? Note that the difference reported is the difference between the two means:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="design-and-analysis-of-experiments.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check our summary data</span></span>
<span id="cb32-2"><a href="design-and-analysis-of-experiments.html#cb32-2" aria-hidden="true" tabindex="-1"></a>sumDat</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   treat   meanYield seYield
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Cont         19.6   0.580
## 2 Herb1        24.7   0.545
## 3 Herb2        26.1   0.546
## 4 Placebo      20.6   0.552</code></pre>
<p>Here it is: <span class="math inline">\(26.2 - 24.2 = 2\)</span></p>
<p>This says that despite the difference we created of ~1 unit of yield between Herb1 and Herb2, when we defined error and generated the data, it created a significant difference detectable with statistics.</p>
</div>
<div id="comparing-the-average-of-the-herbicide-effect-with-the-control." class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> comparing the average of the herbicide effect with the control.</h3>
<p>This might be a comparison you intended to make also… the average effect of herbicides in general. To do this, we expand the idea of -1,1 and 0’s to include 1/2s (and yes, 1/3’s and more are possible):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="design-and-analysis-of-experiments.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb34-2"><a href="design-and-analysis-of-experiments.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare control with the average of herbicide 1 and 2, ignoring the placebo</span></span>
<span id="cb34-3"><a href="design-and-analysis-of-experiments.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the reference -1 and the &#39;other two&#39; a 1/2 each.</span></span>
<span id="cb34-4"><a href="design-and-analysis-of-experiments.html#cb34-4" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>)</span>
<span id="cb34-5"><a href="design-and-analysis-of-experiments.html#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="design-and-analysis-of-experiments.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb34-7"><a href="design-and-analysis-of-experiments.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                          Estimate Std. Error  t value     Pr(&gt;|t|)
## treat c=( -1 0.5 0.5 0 ) 5.803375  0.6805605 8.527346 6.484593e-14
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>Again, checking sumDat</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="design-and-analysis-of-experiments.html#cb36-1" aria-hidden="true" tabindex="-1"></a>sumDat</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   treat   meanYield seYield
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Cont         19.6   0.580
## 2 Herb1        24.7   0.545
## 3 Herb2        26.1   0.546
## 4 Placebo      20.6   0.552</code></pre>
<p><span class="math inline">\((24.2+26.2)/2 = 25.2\)</span> –&gt; <span class="math inline">\(25.2 - 20 = 5.2\)</span></p>
</div>
<div id="writing-this-up" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> writing this up…</h3>
<p>Fill in these blanks using the various contrasts you made above!</p>
<blockquote>
<p>We conclude that herbicides on average cause an _____ gram increase in yield (t = ___ , p = ___ ). We also note that there was a significant difference of _____ grams between the herbicides (t = _____ p = ______). The additional placebo treatment had no effect on yield (t = _______ p = __________).</p>
</blockquote>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="examples-and-challenge-questions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomized-complete-block-design-rcb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introduction to Experimental Design and Analysis.pdf", "Introduction to Experimental Design and Analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
